

{
  "users": [
    {
      "name": "${RABBIT_USER}",
      "password": "${RABBIT_PASS}",
      "tags": "administrator"
    }
  ],
  "vhosts": [
    { "name": "/" }
  ],
  "permissions": [
    {
      "user": "${RABBIT_USER}",
      "vhost": "/",
      "configure": ".*",
      "write": ".*",
      "read": ".*"
    }
  ],
  "queues": [
    { "name": "events", "vhost": "/", "durable": true,
    "arguments": {
        "x-dead-letter-exchange": "events_dlx"
      }
    },
    {
      "name": "events_dlq",
      "vhost": "/",
      "durable": true
    },
    { "name": "chats", "vhost": "/", "durable": true,
    "arguments": {
        "x-dead-letter-exchange": "chats_dlx"
      }
    },
    {
      "name": "chats_dlq",
      "vhost": "/",
      "durable": true
    },
    { "name": "expire", "vhost": "/", "durable": true,
      "arguments": {
        "x-dead-letter-exchange": "expire_dlx"
      }
    },
    { "name": "expire_dlq", "vhost": "/", "durable": true },
    { "name": "ws", "vhost": "/", "durable": true,
      "arguments": {
        "x-dead-letter-exchange": "ws_dlx"
      }
    },
    { "name": "ws_dlq", "vhost": "/", "durable": true }
  ],
  "exchanges": [
    { "name": "events_exchange", "vhost": "/", "type": "direct", "durable": true,
    "auto_delete": false },
    { "name": "chats_exchange", "vhost": "/", "type": "direct", "durable": true,
    "auto_delete": false },
    { "name": "expire_exchange", "vhost": "/", "type": "direct", "durable": true,
    "auto_delete": false },
    { "name": "ws_exchange", "vhost": "/", "type": "direct", "durable": true,
    "auto_delete": false },
    { "name": "events_dlx", "vhost": "/", "type": "fanout", "durable": true },
    { "name": "chats_dlx", "vhost": "/",  "type": "fanout", "durable": true },
    { "name": "expire_dlx", "vhost": "/", "type": "fanout", "durable": true },
    { "name": "ws_dlx", "vhost": "/", "type": "fanout", "durable": true }
  ],
  "bindings": [
     {
      "source": "chats_exchange",
      "destination": "chats",
      "destination_type": "queue",
      "routing_key": "trgt.chats",
      "vhost": "/"
    },    
    {
      "source": "events_exchange",
      "destination": "expire",
      "destination_type": "queue",
      "routing_key": "event.created",
      "vhost": "/"
    },
    {
      "source": "events_exchange",
      "destination": "expire",
      "destination_type": "queue",
      "routing_key": "event.updated",
      "vhost": "/"
    },
    {
      "source": "events_exchange",
      "destination": "expire",
      "destination_type": "queue",
      "routing_key": "event.deleted",
      "vhost": "/"
    },
    {
      "source": "events_exchange",
      "destination": "ws",
      "destination_type": "queue",
      "routing_key": "event.created",
      "vhost": "/"
    },
    {
      "source": "events_exchange",
      "destination": "ws",
      "destination_type": "queue",
      "routing_key": "event.updated",
      "vhost": "/"
    },
    {
      "source": "events_exchange",
      "destination": "ws",
      "destination_type": "queue",
      "routing_key": "event.deleted",
      "vhost": "/"
    },
    {
      "source": "expire_exchange",
      "destination": "events",
      "destination_type": "queue",
      "routing_key": "expire.event",
      "vhost": "/"
    },
    {
      "source": "chats_exchange",
      "destination": "ws",
      "destination_type": "queue",
      "routing_key": "chat.message.created",
      "vhost": "/"
    },
    {
      "source": "events_dlx",
      "destination": "events_dlq",
      "destination_type": "queue",
      "routing_key": "",
      "vhost": "/"
    },
    {
      "source": "chats_dlx",
      "destination": "chats_dlq",
      "destination_type": "queue",
      "routing_key": "",
      "vhost": "/"
    },
    {
      "source": "expire_dlx",
      "destination": "expire_dlq",
      "destination_type": "queue",
      "routing_key": "",
      "vhost": "/"
    },
    {
      "source": "ws_dlx",
      "destination": "ws_dlq",
      "destination_type": "queue",
      "routing_key": "",
      "vhost": "/"
    }
  ]
}